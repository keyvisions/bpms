<!DOCTYPE html>
<html lang="en">

<head>
    <title>BPMN</title>
    <style>
        body {
            margin: 0;
        }
    </style>
    <link rel="stylesheet" type="text/css" href="/styles/bpmn.css" />
    <script src="//code.jquery.com/jquery-2.1.1.min.js"></script>
    <script src="//code.jquery.com/ui/1.11.2/jquery-ui.min.js"></script>
    <script>
        $(function() {
            var toolbar = ["event", "activity", "gateway", "sequenceFlow", "messageFlow", "association", "pool", "lane", "dataObject", "message", "group", "textAnnotation"];
            var ul = document.createElement("ul");
            ul.setAttribute("class", "toolbar");
            toolbar.forEach(function(value) {
                var li = document.createElement("li");
                li.setAttribute("data-type", value);
                li.addEventListener("click", function() {
                    add(this.getAttribute("data-type"));
                });
                li.appendChild(document.createTextNode(value));
                ul.appendChild(li);
            });
            document.body.insertBefore(ul, document.getElementById("bpmn"));
        });

        function add(type) {
            var e = document.createElementNS("http://www.w3.org/2000/svg", "use");
            e.setAttributeNS("http://www.w3.org/1999/xlink", "xlink:href", "#" + type);
            e.setAttribute("x", 100);
            e.setAttribute("y", 100);
            e.addEventListener("click", function () {
               alert("clicked") ;
            });
            document.getElementById("bpmn").appendChild(e);
        }
    </script>
</head>

<body>
    <svg id="bpmn" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
        <symbol id="event">
            <circle class="bpmnElement" cx="25" cy="25" r="25"/>
            <circle class="bpmnElement" cx="25" cy="25" r="20"/>
            <text x="0" y="0">event</text>
        </symbol>
        <symbol id="activity">
            <rect class="bpmnElement" width="100" height="75" rx="10" ry="10"/>
            <text x="50" y="50">activity</text>
        </symbol>
        <symbol id="gateway">
            <rect class="bpmnElement" width="50" height="50" transform="rotate(45, 25, 25)"/>
            <text x="0" y="0">gateway</text>
        </symbol>
        <defs>
            <marker id="markerCircle" markerWidth="8" markerHeight="8" refx="5" refy="5">
                <circle cx="5" cy="5" r="3"></circle>
            </marker>
            <marker id="markerArrowFilled" markerWidth="13" markerHeight="13" refx="2" refy="6" orient="auto">
                <path d="M2,2 L2,11 L10,6 L2,2" style="fill: #000000;"></path>
            </marker>
            <marker id="markerArrowEmpty" markerWidth="13" markerHeight="13" refx="2" refy="6" orient="auto">
                <path d="M2,2 L2,11 L10,6 L2,2"></path>
            </marker>
            <marker id="markerArrow" markerWidth="13" markerHeight="13" refx="2" refy="6" orient="auto">
                <path d="M2,2 L2,11 L10,6"></path>
            </marker>
        </defs>
        <symbol id="sequenceFlow">
            <path data="M0,0 L100,100" style="marker-start: url(#markerCircle); marker-end: url(#markerArrowFilled);"></path>
            <text>sequence</text>
        </symbol>
        <symbol id="messageFlow">
            <path data="M0,0 l100,100 l20,40 l-50,80" style="stroke-dasharray: 10 5; marker-start: url(#markerCircle); marker-end: url(#markerArrow);"></path>
            <text>sequence</text>
        </symbol>
        <symbol id="association">
            <path data="M0,0 L100,100" style="stroke-dasharray: 1 1; marker-end: url(#markerArrow);"></path>
            <text>sequence</text>
        </symbol>
        <symbol id="message">
            <path data="M0,0 L100,100 "></path>
        </symbol>
        <use x="100" y="100" xlink:href="#activity" />
    </svg>
</body>

</html>
